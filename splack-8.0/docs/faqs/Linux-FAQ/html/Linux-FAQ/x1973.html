<HTML
><HEAD
><TITLE
>Solutions to Common Miscellaneous Problems</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.63
"><LINK
REL="HOME"
TITLE="Linux Frequently Asked Questions with Answers"
HREF="index.html"><LINK
REL="PREVIOUS"
TITLE="Porting, Compiling and Obtaining Programs"
HREF="x1700.html"><LINK
REL="NEXT"
TITLE="How To Do This or Find Out That... "
HREF="x2406.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Linux Frequently Asked Questions with Answers</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x1700.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x2406.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN1973"
>7. Solutions to Common Miscellaneous Problems</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN1975"
>7.1. FTP Transfers Seem to Hang.</A
></H2
><P
>FTP transfers that die suddenly are due, apparently, to some form of 
overrunning buffer.  It occurs both with Linux and Microsoft servers.  
On Linux systems, The problem seems to occur most commonly with the 
distribution's server software.  </P
><P
>If you receive 
<TT
CLASS="LITERAL"
>ftp: connection refused</TT
> errors, then the problem
is likely due to a lack of authentication.  Refer to 
``<A
HREF="x1973.html#AEN2037"
><I
>FTP or Telnet Server Won't Allow Logins.</I
></A
>.''</P
><P
>One remedy is to be replacing the distribution FTP server with the
Linux port of the OpenBSD FTP server.  The home page is:
<A
HREF="http://www.eleves.ens.fr:8080/home/madore/programs/"
TARGET="_top"
><TT
CLASS="LITERAL"
>http://www.eleves.ens.fr:8080/home/madore/programs/</TT
></A
></P
><P
>To install the BSD server, follow the installation instructions, and
refer to the manual pages for <TT
CLASS="FILENAME"
>inetd</TT
> and
<TT
CLASS="FILENAME"
>inetd.conf</TT
>.  (If you have the newer 
<TT
CLASS="FILENAME"
>xinetd</TT
>, see below.)  Be sure to tell
<TT
CLASS="FILENAME"
>inetd</TT
> to run the BSD daemon alone, not as a 
subprocess of, for example, <TT
CLASS="FILENAME"
>tcpd</TT
>.  Comment
out the line that begins ``<TT
CLASS="LITERAL"
>ftp</TT
>'' in the 
<TT
CLASS="FILENAME"
>/etc/inetd.conf</TT
> file and replace it with a 
line similar to (if you install the new <TT
CLASS="FILENAME"
>ftpd</TT
>
in <TT
CLASS="FILENAME"
>/usr/local/sbin/</TT
>):</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>&#13;# Original entry, commented out.
#ftp	stream	tcp	nowait	root	/usr/sbin/tcpd /usr/sbin/in.ftpd

# Replacement entry:
ftp	stream	tcp	nowait	root	/usr/local/sbin/ftpd -l&#13;</PRE
></TD
></TR
></TABLE
></P
><P
>The replacement daemon will become effective after rebooting
or sending (as root) a <TT
CLASS="LITERAL"
>SIGHUP</TT
> to 
<TT
CLASS="LITERAL"
>inetd</TT
>, e.g.:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
># kill -HUP inetd</PRE
></TD
></TR
></TABLE
></P
><P
>To configure <TT
CLASS="FILENAME"
>xinetd</TT
>, create an entry in
<TT
CLASS="FILENAME"
>/etc/xinetd.d</TT
> per the instructions in the
<TT
CLASS="FILENAME"
>xinetd.conf</TT
> manual page.  Make sure, 
again, that the command-line arguments for <TT
CLASS="FILENAME"
>ftpd</TT
>
are correct, and that you have installed the <TT
CLASS="FILENAME"
>/etc/ftpusers</TT
>
and <TT
CLASS="FILENAME"
>/etc/pam.d/ftp</TT
> files.  Then restart 
<TT
CLASS="FILENAME"
>xinetd</TT
> with the command: 
<TT
CLASS="LITERAL"
>/etc/rc.d/init.d/xinetd restart</TT
>.  The command 
should report ``OK,'' and the restart will be noted in the 
system message log.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2010"
>7.2. Free Dumps Core.</A
></H2
><P
>In Linux 1.3.57 and later, the format of <TT
CLASS="FILENAME"
>/proc/meminfo</TT
> 
was changed in
a way that the implementation of <SPAN
CLASS="APPLICATION"
>free</SPAN
> 
doesn't understand.

Get the latest version, from metalab.unc.edu, in
<TT
CLASS="FILENAME"
>/pub/Linux/system/Status/ps/procps-0.99.tgz</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2016"
>7.3. Netscape Crashes Frequently.</A
></H2
><P
>Netscape shouldn't crash, if it and the network are properly configured.
Some things to check:</P
><P
><P
></P
><UL
><LI
><P
> 
Make sure that the <TT
CLASS="LITERAL"
>MOZILLA_HOME</TT
> environment
variable is correctly set.  If you installed Netscape under
<TT
CLASS="FILENAME"
>/usr/local/netscape/</TT
>, for example, that should be
the value of <TT
CLASS="LITERAL"
>MOZILLA_HOME</TT
>.  Set it from the command
line (e.g, ``<TT
CLASS="LITERAL"
>export
MOZILLA_HOME="/usr/local/netscape"</TT
>'' under
<B
CLASS="COMMAND"
>bash</B
> or add it to one your personal or system
initialization files.  Refer to the manual page for your shell for
details.</P
></LI
><LI
><P
> 
If you have a brand-new version of Netscape, try a previous version,
in case the run-time libraries are slightly incompatible.  For
example, if Netscape version 4.75 is installed (type
``<TT
CLASS="LITERAL"
>netscape --version</TT
>'' at the shell prompt), try
installing version 4.7.  All versions are archived at
<A
HREF="ftp://ftp.netscape.com/"
TARGET="_top"
><TT
CLASS="LITERAL"
>ftp://ftp.netscape.com/</TT
></A
>.  </P
></LI
><LI
><P
>Netscape uses its own Motif and Java Runtime Environment libraries.  If
a separate version of either is installed on your system, ensure that 
they aren't interfering with Netscape's libraries; e.g., by un-installing
them.</P
></LI
><LI
><P
>Make sure that Netscape can connect to its default name servers.  The program 
will appear to freeze and time out after several minutes if it can't.
This indicates a problem with the system's Internet connection; likely,
the system can't connect to other sites, either.</P
></LI
></UL
></P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2037"
>7.4. FTP or Telnet Server Won't Allow Logins.</A
></H2
><P
>This applies to server daemons that respond to clients, but don't
allow logins.  On new systems that have Pluggable Authentication
Modules installed, look for a file named,
``<TT
CLASS="FILENAME"
>ftp</TT
>,'' or ``<TT
CLASS="FILENAME"
>telnet</TT
>,'' in the
directory <TT
CLASS="FILENAME"
>/etc/pam/</TT
> or
<TT
CLASS="FILENAME"
>/etc/pam.d/</TT
>.  If the corresponding authentication
file doesn't exist, the instructions for configuring FTP and Telnet
authentication and other PAM configuration, should be in
<TT
CLASS="LITERAL"
>/usr/doc/pam-&#60;version&#62;</TT
>. Refer also to the 
answer for ``<A
HREF="x3182.html#AEN3504"
><I
>FTP server says: ``421 service not available, remote server has closed connection.''</I
></A
>.''</P
><P
>If it's an FTP server on an older system, make sure that the account
exists in <TT
CLASS="FILENAME"
>/etc/passwd</TT
>, especially
``<TT
CLASS="LITERAL"
>anonymous</TT
>.''</P
><P
>This type of problem may also be caused a failure to resolve the host
addresses properly, especially if using Reverse Address Resolution
Protocol (RARP).  The simple answer to this is to list all relevant
host names and IP addresses in the <TT
CLASS="FILENAME"
>/etc/hosts</TT
>
files on each machine.  ( Refer to the example
<TT
CLASS="FILENAME"
>/etc/hosts</TT
> and
<TT
CLASS="FILENAME"
>/etc/resolv.conf</TT
> files in: ``<A
HREF="x2406.html#AEN2581"
><I
><I
>Sendmail</I
> Pauses for
Up to a Minute at Each Command.</I
></A
>.'')  If the network
has an internal DNS, make sure that each host can resolve network
addresses using it.</P
><P
>If the host machine doesn't respond to FTP or Telnet clients at all,
then the server daemon is not installed correctly, or at all.  Refer
to the manual pages: <TT
CLASS="LITERAL"
>inetd</TT
> and
<TT
CLASS="LITERAL"
>inetd.conf</TT
> on older systems, or 
<TT
CLASS="LITERAL"
>xinetd</TT
> and <TT
CLASS="LITERAL"
>xinetd.conf</TT
>, as well
as <TT
CLASS="LITERAL"
>ftpd</TT
>, and <TT
CLASS="LITERAL"
>telnetd</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2061"
>7.5. How To Keep Track of Bookmarks in Netscape?</A
></H2
><P
>This probably applies to most other browsers, too. In the
Preferences/Navigator menu, set your home page to Netscape's
<TT
CLASS="FILENAME"
>bookmarks.html</TT
> file, which is located in the
<TT
CLASS="FILENAME"
>.netscape</TT
> (with a leading period)
subdirectory. For example, if your login name is
``<TT
CLASS="LITERAL"
>smith</TT
>,'' set the home page to:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   file://home/smith/.netscape/bookmarks.html</PRE
></TD
></TR
></TABLE
></P
><P
>Setting up your personal home page like this will present you with a
nicely formatted (albeit possibly long) page of bookmarks when
Netscape starts. And the file is automatically updated whenever you
add, delete, or visit a bookmarked site.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2070"
>7.6. The Computer Has the Wrong Time.</A
></H2
><P
>There are two clocks in your computer. The hardware (CMOS) clock runs
even when the computer is turned off, and is used when the system
starts up and by DOS (if you use DOS). The ordinary system time, shown
and set by <B
CLASS="COMMAND"
>date</B
>, is maintained by the kernel while Linux is
running.</P
><P
>You can display the CMOS clock time, or set either clock from the
other, with <TT
CLASS="FILENAME"
>/sbin/clock</TT
> (now called 
<B
CLASS="COMMAND"
>hwclock</B
> in many
distributions).  Refer to: <TT
CLASS="LITERAL"
>man 8 clock</TT
> or 
<TT
CLASS="LITERAL"
>man 8 hwclock</TT
>.</P
><P
>There are various other programs that can correct either or both
clocks for system drift or transfer time across the network. Some of
them may already be installed on your system. Try looking for 
<B
CLASS="COMMAND"
>adjtimex</B
>
(corrects for drift), Network Time Protocol clients like 
<B
CLASS="COMMAND"
>netdate</B
>, <B
CLASS="COMMAND"
>getdate</B
>, 
and <B
CLASS="COMMAND"
>xntp</B
>, or NTP client-server suite like
<B
CLASS="COMMAND"
>chrony</B
>.  Refer to:
``<A
HREF="x25.html#AEN103"
><I
>How to Find a Particular Application.</I
></A
>.''</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2086"
>7.7. Setuid Scripts Don't Seem to Work.</A
></H2
><P
>That's right. This feature has been disabled in the Linux kernel on
purpose, because setuid scripts are almost always a security hole.
<SPAN
CLASS="APPLICATION"
>Sudo</SPAN
> and 
<SPAN
CLASS="APPLICATION"
>SuidPerl</SPAN
> can provide more 
security than setuid scripts or
binaries, especially if execute permissions are limited to a certain
user ID or group ID.</P
><P
>If you want to know why setuid scripts are a security hole, read the
FAQ for <I
CLASS="CITETITLE"
>comp.unix.questions</I
>.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2093"
>7.8. Free Memory as Reported by <B
CLASS="COMMAND"
>free</B
> Keeps Shrinking.</A
></H2
><P
>The ``<TT
CLASS="LITERAL"
>free</TT
>'' figure printed by
<B
CLASS="COMMAND"
>free</B
> doesn't include memory used as a disk buffer
cache&#8212;shown in the ``<TT
CLASS="LITERAL"
>buffers</TT
>'' column.  If you
want to know how much memory is really free add the
``<TT
CLASS="LITERAL"
>buffers</TT
>'' amount to ``<TT
CLASS="LITERAL"
>free</TT
>.''
Newer versions of <B
CLASS="COMMAND"
>free</B
> print an extra line with
this info.</P
><P
>The disk buffer cache tends to grow soon after starting Linux up. As
you load more programs and use more files, the contents get cached. It
will stabilize after a while.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2104"
>7.9. When Adding More Memory, the System Slows to a Crawl.</A
></H2
><P
>This is a common symptom of a failure to cache the additional memory.
The exact problem depends on your motherboard.</P
><P
>Sometimes you have to enable caching of certain regions in your BIOS
setup. Look in the CMOS setup and see if there is an option to cache
the new memory area which is currently switched off. This is
apparently most common on a '486.</P
><P
>Sometimes the RAM has to be in certain sockets to be cached.</P
><P
>Sometimes you have to set jumpers to enable caching.</P
><P
>Some motherboards don't cache all of the RAM if you have more RAM per
amount of cache than the hardware expects. Usually a full 256K cache
will solve this problem.</P
><P
>If in doubt, check the manual. If you still can't fix it because the
documentation is inadequate, you might like to post a message to
<I
CLASS="CITETITLE"
>comp.os.linux.hardware</I
> 
giving all of the details&#8212;make, model number,
date code, etc., so other Linux users can avoid it.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2113"
>7.10. Some Programs (E.g. <B
CLASS="COMMAND"
>xdm</B
>) Won't Allow Logins.</A
></H2
><P
>You are probably using non-shadow password programs and are using
shadow passwords.</P
><P
>If so, you have to get or compile a shadow password version of the
programs in question. The shadow password suite can be found at
<A
HREF="ftp://tsx-11.mit.edu:/pub/linux/sources/usr.bin/shadow/"
TARGET="_top"
><TT
CLASS="LITERAL"
>ftp://tsx-11.mit.edu:/pub/linux/sources/usr.bin/shadow/</TT
></A
>. This is the source code. The binaries are probably in
<TT
CLASS="FILENAME"
>linux/binaries/usr.bin/</TT
>.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2121"
>7.11. Some Programs Allow Logins with No Password.</A
></H2
><P
>You probably have the same problem as in 
(``<A
HREF="x1973.html#AEN2113"
><I
>Some Programs (E.g. <I
>xdm</I
>) Won't Allow Logins.</I
></A
>''), with an added wrinkle.</P
><P
>If you are using shadow passwords, you should put a letter
`<TT
CLASS="LITERAL"
>x</TT
>' or an asterisk in the password field of
<TT
CLASS="FILENAME"
>/etc/passwd</TT
> for each account, so that if a
program doesn't know about the shadow passwords it won't think it's a
passwordless account and let anyone in.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2128"
>7.12. The Machine Runs Very Slowly with GCC / X / ...</A
></H2
><P
>You may have too little real memory. If you have less RAM than all the
programs you're running at once, Linux will swap to your hard disk
instead and thrash horribly. The solution in this case is to not run
so many things at once or buy more memory. You can also reclaim some
memory by compiling and using a kernel with less options configured.
See 
(``<A
HREF="x2406.html#AEN2845"
><I
>How To Upgrade/Recompile a Kernel.</I
></A
>'')</P
><P
>You can tell how much memory and swap you're using with the free
command, or by typing:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   $ cat /proc/meminfo</PRE
></TD
></TR
></TABLE
></P
><P
>If your kernel is configured with a RAM disk, this is probably wasted
space and will cause things to go slowly. Use LILO or rdev to tell the
kernel not to allocate a RAM disk (see the LILO documentation or type
``<TT
CLASS="LITERAL"
>man rdev</TT
>'').</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2137"
>7.13. System Only Allows Root Logins.</A
></H2
><P
>You probably have some permission problems, or you have a file
<TT
CLASS="FILENAME"
>/etc/nologin</TT
>.</P
><P
>In the latter case, put ``<TT
CLASS="LITERAL"
>rm -f /etc/nologin</TT
>''
in your <TT
CLASS="FILENAME"
>/etc/rc.local</TT
> or
<TT
CLASS="FILENAME"
>/etc/rc.d/*</TT
> scripts.</P
><P
>Otherwise, check the permissions on your shell, and any file names
that appear in error messages, and also the directories that contain
these files, up to and including the root directory.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2146"
>7.14. The Screen Is All Full of Weird Characters Instead of Letters.</A
></H2
><P
>You probably sent some binary data to your screen by mistake. Type
<TT
CLASS="LITERAL"
>echo '\033c'</TT
> to fix it. 
Many Linux distributions have a command,
<B
CLASS="COMMAND"
>reset</B
>, that does this.</P
><P
>If that doesn't help, try a direct screen escape command.</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   $ echo '<B
CLASS="KEYCAP"
>Ctrl</B
>-<B
CLASS="KEYCAP"
>V</B
> <B
CLASS="KEYCAP"
>Ctrl</B
>-<B
CLASS="KEYCAP"
>O</B
>'</PRE
></TD
></TR
></TABLE
></P
><P
>This resets the default font of a Linux console. Remember to hold down
the Control key and type the letter, instead of, for example,
<B
CLASS="KEYCAP"
>Ctrl</B
>, then 
<B
CLASS="KEYCAP"
>V</B
>. The sequence</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   $ echo '<B
CLASS="KEYCAP"
>Ctrl</B
>-<B
CLASS="KEYCAP"
>V</B
> <B
CLASS="KEYCAP"
>Esc</B
> <B
CLASS="KEYCAP"
>C</B
>'</PRE
></TD
></TR
></TABLE
></P
><P
>causes a full screen reset. If there's data left on the shell command
line after typing a binary file, press <B
CLASS="KEYCAP"
>Ctrl</B
>-<B
CLASS="KEYCAP"
>C</B
> a few times to restore
the shell command line.</P
><P
>Another possible command is an alias, ``<TT
CLASS="LITERAL"
>sane</TT
>,''
that can work with generic terminals:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>     $ alias sane='echo -e "\\033c";tput is2; \
     &#62; stty sane line 1 rows $LINES columns $COLUMNS'</PRE
></TD
></TR
></TABLE
></P
><P
>The alias is enclosed with open quotes (backticks), not single quotes.
The line break is included here for clarity, and is not required.</P
><P
>Make sure that <TT
CLASS="LITERAL"
>$LINES</TT
> and <TT
CLASS="LITERAL"
>$COLUMNS</TT
>
are defined in the environment with a command similar to this in 
<TT
CLASS="FILENAME"
>~/.cshrc</TT
> or <TT
CLASS="FILENAME"
>~/.bashrc</TT
>,</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>     $ LINES=25; export $LINES; $COLUMNS=80; export $COLUMNS</PRE
></TD
></TR
></TABLE
></P
><P
>using the correct numbers of <TT
CLASS="LITERAL"
>$LINES</TT
> and 
<TT
CLASS="LITERAL"
>$COLUMNS</TT
> for the terminal.</P
><P
>Finally, the output of ``<B
CLASS="COMMAND"
>stty -g</B
>'' can be used to 
create a shell script that will reset the terminal:</P
><P
></P
><OL
TYPE="1"
><LI
><P
>Save the output of ``<B
CLASS="COMMAND"
>stty -g</B
>'' to a file.  In
this example, the file is named ``termset.'':</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>          $ stty -g &#62;termset</PRE
></TD
></TR
></TABLE
></P
><P
>The output of ``<B
CLASS="COMMAND"
>stty -g</B
>'' (the contents of 
``<TT
CLASS="FILENAME"
>termset</TT
>'') will 
look something like:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>          500:5:bd:8a3b:3:1c:7f:15:4:0:1:0:11:13:1a:0:12:f:17:16:0:0:73</PRE
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Edit ``<TT
CLASS="FILENAME"
>termset</TT
>'' to become a shell
script; adding an interpreter and ``<B
CLASS="COMMAND"
>stty</B
>''
command:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>           #!/bin/bash
           stty 500:5:bd:8a3b:3:1c:7f:15:4:0:1:0:11:13:1a:0:12:f:17:16:0:0:73</PRE
></TD
></TR
></TABLE
></P
></LI
><LI
><P
>Add executable permissions to ``<B
CLASS="COMMAND"
>termset</B
>'' and 
use as a shell script:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>           $ chmod +x termset
           $ ./termset</PRE
></TD
></TR
></TABLE
></P
></LI
></OL
><P
>[Floyd L. Davidson, Bernhard Gabler]</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2216"
>7.15. I Screwed Up the System and Can't Log In to Fix It.</A
></H2
><P
>Reboot from an emergency floppy or floppy pair. For example, the
Slackware boot and root disk pair in the install subdirectory of the
Slackware distribution.</P
><P
>There are also two, do-it-yourself rescue disk creation packages in
<A
HREF="ftp://metalab.unc.edu/pub/Linux/system/Recovery/"
TARGET="_top"
><TT
CLASS="LITERAL"
>ftp://metalab.unc.edu/pub/Linux/system/recovery/</TT
></A
>.
These are better because they have your own kernel on them, so you
don't run the risk of missing devices and file systems.</P
><P
>Get to a shell prompt and mount your hard disk with something like</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   $ mount -t ext2 /dev/hda1 /mnt</PRE
></TD
></TR
></TABLE
></P
><P
>Then your file system is available under the directory 
<TT
CLASS="FILENAME"
>/mnt</TT
> and you
can fix the problem. Remember to unmount your hard disk before
rebooting (<B
CLASS="COMMAND"
>cd</B
> somewhere else 
first, or it will say it's busy).</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2228"
>7.16. I Forgot the <TT
CLASS="LITERAL"
>root</TT
> Password.</A
></H2
><P
><EM
>Note:  Incorrectly editing any of the files in the 
<TT
CLASS="FILENAME"
>/etc/</TT
> directory can severely screw up
a system.  Please keep a spare copy of any files in case 
you make a mistake.</EM
></P
><P
>If your Linux distribution permits, try booting into single-user
mode by typing ``<TT
CLASS="LITERAL"
>single</TT
>'' at the 
<TT
CLASS="LITERAL"
>BOOT lilo:</TT
> prompt.  With more recent 
distributions, you can boot into single-user mode when
prompted by typing ``<TT
CLASS="LITERAL"
>linux 1</TT
>'' or 
``<TT
CLASS="LITERAL"
>init=/bin/bash</TT
>.''  </P
><P
>In that case, boot from the installation
or rescue floppy, and switch to another virtual console with
<B
CLASS="KEYCAP"
>Alt</B
>-<B
CLASS="KEYCAP"
>F1</B
>--
<B
CLASS="KEYCAP"
>Alt</B
>-<B
CLASS="KEYCAP"
>F8</B
>, 
and then mount the root file system on <TT
CLASS="LITERAL"
>/mnt</TT
>.
Then proceed with the steps below to determine if your system
has standard or shadow passwords, and how to remove the 
password.</P
><P
>Using your favorite text editor, edit the root entry of 
the <TT
CLASS="FILENAME"
>/etc/passwd</TT
> file to remove 
the password, which is located between the first and second
colons.  <EM
>Do this only if the password field does not
contain an ``<TT
CLASS="LITERAL"
>x</TT
>,'' in which case see
below.</EM
></P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   root:Yhgew13xs:0:0: ...</PRE
></TD
></TR
></TABLE
></P
><P
>Change that to: </P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   root::0:0: ...</PRE
></TD
></TR
></TABLE
></P
><P
>If the password field contains an ``<TT
CLASS="LITERAL"
>x</TT
>,''
then you must remove the password from the <TT
CLASS="FILENAME"
>/etc/shadow</TT
>
file, which roughly the same format.  </P
><P
>[Paul Colquhuon, Robert Kiesling]</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2260"
>7.17. There's a Huge Security Hole in <B
CLASS="COMMAND"
>rm</B
>!</A
></H2
><P
>No there isn't. You are obviously new to unices and need to read a
good book to find out how things work. Clue: the ability to delete
files depends on permission to write in that directory.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2264"
>7.18. <B
CLASS="COMMAND"
>lpr</B
> and/or <B
CLASS="COMMAND"
>lpd</B
> Don't Work.</A
></H2
><P
>First make sure that your <TT
CLASS="FILENAME"
>/dev/lp*</TT
> port is 
correctly configured. Its
IRQ (if any) and port address need to match the settings on the
printer card. You should be able to dump a file directly to the
printer:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   $ cat the_file &#62;/dev/lp1</PRE
></TD
></TR
></TABLE
></P
><P
>If <B
CLASS="COMMAND"
>lpr</B
> gives you a message like
<TT
CLASS="LITERAL"
>myname@host: host not found</TT
>" it may mean that the
TCP/IP loopback interface, <TT
CLASS="LITERAL"
>lo</TT
>, isn't working
properly. Loopback support is compiled into most distribution kernels.
Check that the interface is configured with the ifconfig command. By
Internet convention, the network number is 127.0.0.0, and the local
host address is 127.0.0.1. If everything is configured correctly, you
should be able to telnet to your own machine and get a login prompt.</P
><P
>Make sure that <TT
CLASS="FILENAME"
>/etc/hosts.lpd</TT
> contains the 
machine's host name.</P
><P
>If your machine has a network-aware <B
CLASS="COMMAND"
>lpd</B
>, like the
one that comes with LPRng, make sure that
<TT
CLASS="FILENAME"
>/etc/lpd.perms</TT
> is configured correctly.

Also look at the <I
CLASS="CITETITLE"
>Printing HOWTO</I
>. 
"Where can I get the HOWTO's and other documentation? ".</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2282"
>7.19. Timestamps on Files on MS-DOS Partitions Are Set Incorrectly</A
></H2
><P
>There is a bug in the program <B
CLASS="COMMAND"
>clock</B
> 
(often found in <TT
CLASS="FILENAME"
>/sbin</TT
>). It
miscounts a time zone offset, confusing seconds with minutes or
something like that. Get a recent version.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2287"
>7.20. How To Get LILO to Boot the Kernel Image.</A
></H2
><P
>&#62;From kernel versions 1.1.80 on, the compressed kernel image, which is
what LILO needs to find, is in <TT
CLASS="FILENAME"
>arch/i386/boot/zImage</TT
>, or
<TT
CLASS="FILENAME"
>arch/i386/boot/bzImage</TT
> when it is built, 
and is normally stored in the
<TT
CLASS="FILENAME"
>/boot/</TT
> directory. The 
<TT
CLASS="FILENAME"
>/etc/lilo.conf</TT
> file should refer to the 
<TT
CLASS="FILENAME"
>vmlinuz</TT
>
symbolic link, not the actual kernel image.</P
><P
>This was changed to make it easier to build kernel versions for
several different processors from one source tree.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2296"
>7.21. How To Make Sure the System Boots after Re-Installing 
the Operating System.</A
></H2
><P
>This should work whether you're re-installing Linux or some other, 
commercial, operating system:</P
><P
></P
><UL
><LI
><P
>Insert a blank, formatted floppy in drive A:</P
></LI
><LI
><P
>Save a copy of the boot hard drive's Master Boot Record to the 
floppy, by executing the command: </P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>#dd if=/dev/hda of=/dev/fd0 count=1</PRE
></TD
></TR
></TABLE
></P
><P
><TT
CLASS="LITERAL"
>dd</TT
> is a standard program on Linux systems.  A 
MS-Windows compatible version is available from 
<A
HREF="ftp://ftp.gnu.org/"
TARGET="_top"
><TT
CLASS="LITERAL"
>ftp://ftp.gnu.org/</TT
></A
>, as well as many MS software archives.</P
></LI
><LI
><P
>Test that the floppy boots the system by rebooting with the floppy
in the A: drive.  </P
></LI
><LI
><P
>Then you should be able to install the other operating system (on 
a different hard drive and/or partition, if you don't want to 
uninstall Linux).</P
></LI
><LI
><P
>After installation, boot Linux again from the floppy, and re-install
the MBR with the command: <TT
CLASS="FILENAME"
>/sbin/lilo</TT
>.</P
></LI
></UL
><P
>[Jacques Guy]</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2318"
>7.22. The PCMCIA Card Doesn't Work after Upgrading the Kernel.</A
></H2
><P
>The PCMCIA Card Services modules, which are located in
<TT
CLASS="FILENAME"
>/lib/modules/</TT
><EM
>version</EM
><TT
CLASS="FILENAME"
>/pcmcia</TT
>,
where <EM
>version</EM
> is the version number of the
kernel, use configuration information that is specific to that kernel
image only. The PCMCIA modules on your system will not work with a
different kernel image. You need to upgrade the PCMCIA card modules
when you upgrade the kernel.</P
><P
>When upgrading from older kernels, make sure that you have the most recent
version of the run-time libraries, the modutils package, and so on.
Refer to the file <TT
CLASS="FILENAME"
>Documentation/Changes</TT
> 
in the kernel source tree for details.</P
><P
>Important: If you use the PCMCIA Card Services, do not enable the
<TT
CLASS="LITERAL"
>Network device support/Pocket and portable adapters</TT
>
option of the kernel configuration menu, as this conflicts with the
modules in Card Services.</P
><P
>Knowing the PCMCIA module dependencies of the old kernel is useful.
You need to keep track of them. For example, if your PCMCIA card
depends on the serial port character device being installed as a
module for the old kernel, then you need to ensure that the serial
module is available for the new kernel and PCMCIA modules as well.</P
><P
>The procedure described here is somewhat kludgey, but it is much easier
than re-calculating module dependencies from scratch, and making sure
the upgrade modules get loaded so that both the non-PCMCIA and PCMCIA
are happy. Recent kernel releases contain a myriad of module options,
too many to keep track of easily. These steps use the existing module
dependencies as much as possible, instead of requiring you to
calculate new ones.</P
><P
>However, this procedure does not take into account instances where
module dependencies are incompatible from one kernel version to
another. In these cases, you'll need to load the modules yourself with
insmod, or adjust the module dependencies in the
<TT
CLASS="FILENAME"
>/etc/conf.modules</TT
> file. The
<TT
CLASS="FILENAME"
>Documentation/modules.txt</TT
> file in the kernel
source tree contains a good description of how to use the kernel
loadable modules and the module utilities like
<B
CLASS="COMMAND"
>insmod</B
>, <B
CLASS="COMMAND"
>modprobe</B
>, and
<B
CLASS="COMMAND"
>depmod</B
>.  <TT
CLASS="FILENAME"
>Modules.txt</TT
> also
contains a recommended procedure for determining which features to
include in a resident kernel, and which to build as modules.</P
><P
>Essentially, you need to follow these steps when you install a new
kernel.</P
><P
></P
><UL
><LI
><P
> Before building the new kernel, make a record with
the <B
CLASS="COMMAND"
>lsmod</B
> command of the module dependencies that
your system currently uses. For example, part of the
<B
CLASS="COMMAND"
>lsmod</B
> output might look like this:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   Module         Pages    Used by
   memory_cs          2            0
   ds                 2    [memory_cs]     3
   i82365             4            2
   pcmcia_core        8    [memory_cs ds i82365]   3
   sg                 1            0
   bsd_comp           1            0
   ppp                5    [bsd_comp]      0
   slhc               2    [ppp]   0
   serial             8            0
   psaux              1            0
   lp                 2            0</PRE
></TD
></TR
></TABLE
></P
><P
>This tells you for example that the <TT
CLASS="FILENAME"
>memory_cs</TT
> 
module needs the ds
and <TT
CLASS="FILENAME"
>pcmcia_core</TT
> modules loaded first. 
What it doesn't say is that,
in order to avoid recalculating the module dependencies, you may
also need to have the <TT
CLASS="FILENAME"
>serial</TT
>, 
<TT
CLASS="FILENAME"
>lp</TT
>, <TT
CLASS="FILENAME"
>psaux</TT
>, and other standard
modules available to prevent errors when installing the pcmcia
routines at boot time with <B
CLASS="COMMAND"
>insmod</B
>. 
A glance at the <TT
CLASS="FILENAME"
>/etc/modules</TT
> file will tell
you what modules the system currently loads, and in what order.
Save a copy of this file for future reference, until you have
successfully installed the new kernel's modules. Also save the 
<B
CLASS="COMMAND"
>lsmod</B
>
output to a file, for example, with the command:
<B
CLASS="COMMAND"
>lsmod &#62;lsmod.old-kernel.output</B
>.</P
></LI
><LI
><P
> Build the new kernel, and install the boot image, either 
<TT
CLASS="FILENAME"
>zImage</TT
> or
<TT
CLASS="FILENAME"
>bzImage</TT
>, to a floppy diskette. To do this, change to the
<TT
CLASS="FILENAME"
>arch/i386/boot</TT
> directory (substitute the 
correct architecture
directory if you don't have an Intel machine), and, with a floppy
in the diskette drive, execute the command:</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>   $ dd if=bzImage of=/dev/fd0 bs=512</PRE
></TD
></TR
></TABLE
></P
><P
>if you built the kernel with the <B
CLASS="COMMAND"
>make bzImage</B
> 
command, and if
your floppy drive is <TT
CLASS="FILENAME"
>/dev/fd0</TT
>. 
This results in a bootable kernel
image being written to the floppy, and allows you to try out the
new kernel without replacing the existing one that LILO boots on
the hard drive.</P
></LI
><LI
><P
>Boot the new kernel from the floppy to make sure that it works.</P
></LI
><LI
><P
>With the system running the new kernel, compile and install a current
version of the PCMCIA Card Services package, available from
metalab.unc.edu as well as other Linux archives. Before installing the
Card Services utilities, change the names of
<TT
CLASS="FILENAME"
>/sbin/cardmgr</TT
> and
<TT
CLASS="FILENAME"
>/sbin/cardctl</TT
> to
<TT
CLASS="FILENAME"
>/sbin/cardmgr.old</TT
> and
<TT
CLASS="FILENAME"
>/sbin/cardctl.old</TT
>. The old versions of these
utilities are not compatible with the replacement utilities that Card
Services installs. In case something goes awry with the installation,
the old utilities won't be overwritten, and you can revert to the
older versions if necessary. When configuring Card Services with the
``<TT
CLASS="LITERAL"
>make config</TT
>'' command, make sure that the build
scripts know where to locate the kernel configuration, either by using
information from the running kernel, or telling the build process
where the source tree of the new kernel is. The ``<TT
CLASS="LITERAL"
>make
config</TT
>'' step should complete without errors. Installing the
modules from the Card Services package places them in the directory
<TT
CLASS="FILENAME"
>/lib/modules/</TT
><EM
>version</EM
><TT
CLASS="FILENAME"
>/pcmcia</TT
>,
where <EM
>version</EM
> is the version number of the new
kernel.</P
></LI
><LI
><P
>Reboot the system, and note which, if any, of the PCMCIA devices
work. Also make sure that the non-PCMCIA hardware devices are
working. It's likely that some or all of them won't work. Use
<B
CLASS="COMMAND"
>lsmod</B
> to determine which modules the kernel 
loaded at boot time,
and compare it with the module listing that the old kernel loaded,
which you saved from the first step of the procedure. (If you
didn't save a listing of the <B
CLASS="COMMAND"
>lsmod</B
> output, 
go back and reboot the old kernel, and make the listing now.)</P
></LI
><LI
><P
>When all modules are properly loaded, you can replace the old
kernel image on the hard drive. This will most likely be the file
pointed to by the <TT
CLASS="FILENAME"
>/vmlinuz</TT
> symlink. 
Remember to update the boot
sector by running the <B
CLASS="COMMAND"
>lilo</B
> command after 
installing the new kernel image on the hard drive.</P
></LI
></UL
><P
>    
Also look at the questions, How do I upgrade/recompile my kernel?
and Modprobe can't locate module, "XXX," and similar messages.</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2389"
>7.23. How To Remove (or Change) the Colors in the 
<SPAN
CLASS="APPLICATION"
>ls</SPAN
> Display.</A
></H2
><P
>The shell command, ``<TT
CLASS="LITERAL"
>unalias ls</TT
>,'' should
completely unset the configuration that some distributions provide as
standard.  To change the colors, refer to the 
<SPAN
CLASS="APPLICATION"
>ls</SPAN
> man page (``<TT
CLASS="LITERAL"
>man ls</TT
>'').</P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN2396"
>7.24. Why Won't a Program Work in the Current Directory?</A
></H2
><P
>Because the current directory (i.e., ``<TT
CLASS="LITERAL"
>.</TT
>'') is not
in the search path, for security reasons, as well as to insure that
the correct program versions are used.  If an intruder is able to
write a file to a world-writable directory, like
<TT
CLASS="FILENAME"
>/tmp</TT
>, presumably he or she would be able to
execute it if the directory were in the search path.  The solution to
this is to include the directory in the command; e.g.,
``<TT
CLASS="LITERAL"
>./myprog</TT
>,'' instead of
``<TT
CLASS="LITERAL"
>myprog</TT
>.'' Or add the current directory to your
<TT
CLASS="LITERAL"
>PATH</TT
> environment variable; e.g., 
``<TT
CLASS="LITERAL"
>export PATH=".:"$PATH</TT
>'' using
<SPAN
CLASS="APPLICATION"
>bash</SPAN
>, although this is discouraged for the
reasons mentioned above.</P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x1700.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x2406.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Porting, Compiling and Obtaining Programs</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>How To Do This or Find Out That...</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>